<!DOCTYPE html>
<html lang="en">
<head>
  <script src="//use.typekit.net/lyx0zwz.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Step 3—Saving text locally | Modile Design Class</title>
  <link rel="stylesheet" href="/css/prism.css">
  <link rel="stylesheet" href="/css/reader.css">

  <!-- Typekit -->
  <script>try{Typekit.load();}catch(e){}</script>

  <!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
mixpanel.init("4d280a20e4ff4df18ea40eb616429130");</script><!-- end Mixpanel -->
</head>
<body>
  <main id="main">
    <header>
      <p>
        <a id="chapter" href="/ios-app/quick-thoughts/index.html">Example Project—Quick Thoughts</a>


      </p>
      <p>
        <a href='/'>Mobile Design Class</a>
      </p>
    </header>

    <article>
      <root><h1>Step 3—Saving text locally</h1><p>We want to save the text locally before saving the text into other services. We monitor the content change of the text view and save the text locally.</p><ol><li>Make sure we have set the delegate of the <code>UITextView</code> to the <code>ViewController</code>.</li><li>Since we have set the delegate, we need to include the <code>UITextViewDelegate</code> in the class header line. The <code>ViewController</code> class declaration becomes the following:<br />  <pre><code class="language-swift">  class ViewController: UIViewController, UITextViewDelegate {
}</code></pre><li>At the beginning of the <code>ViewController.swift</code> file, we add the following constant.<pre><code class="language-swift">let SAVED_TEXT_KEY = "SAVED_TEXT_KEY"</code></pre></li><br /><li>Somewhere in the code, we addd the following block of logic:<pre><code class="language-swift">// MARK: - TextView Content

func initTextViewContent() {
  self.mainTextView.text = ""

  // try to load from NSUserDefault.
  let userDefault = NSUserDefaults.standardUserDefaults()
  if (userDefault.objectForKey(SAVED_TEXT_KEY) != nil) {
      self.mainTextView.text = userDefault.stringForKey(SAVED_TEXT_KEY)
  }
}

func textViewDidChange(textView: UITextView) {
  // save to NSUserDefault until save.
  let userDefault = NSUserDefaults.standardUserDefaults()
  userDefault.setObject(textView.text, forKey: SAVED_TEXT_KEY)
}</code></pre></li><br /><li>Then we update the <code>viewDidLoad</code> method to call the <code>initTextViewContent</code> function.</li><br />  <pre><code class="language-swift">override func viewDidLoad() {
  super.viewDidLoad()
  // Do any additional setup after loading the view, typically from a nib.

  initTextViewContent()

  registerKeyboardEvents()

  mainTextView.becomeFirstResponder()
}</code></pre></li></ol><h2 id="what-just-happened?"><a href="#what-just-happened?">What just happened?</a></h2><p>We just stored our text locally and restore the text every time the app launches. At this moment, the app serves as a quick note taking utility that what you have written is always there for you to porcess.</p><h2 id="declaring-delegate-in-class-header"><a href="#declaring-delegate-in-class-header">Declaring Delegate in Class Header</a></h2><p>Back in the Objective-C time, compiler warns us when we miss any delegation declaration. We had to declare what delegate the class handles to get rid of the warning. In the swift compiler, the warning is gone. But I still keep this good habit. 2 reasons:</p><p>1. I can easily <em>command+click</em> on the class header to view the list of delegate methodns that I can use.<br />2. If there is any required functions in the delegate, the complier throws errors and fail to build. This prevent run-time crash when the original logic call the required delegate functions and not found.</p></root>
    </article>

    <nav>

      <a id="prev" href="/ios-app/quick-thoughts/step2-handle-keyboard-size.html">← Handling keyboard size changes</a>

      <a id="next" href="/ios-app/quick-thoughts/step4-basic-sharing-function.html">Step 4—Basic Sharing Function →</a>
    </nav>


    <a href="/ios-app/quick-thoughts/step2-handle-keyboard-size.html" title="← Handling keyboard size changes" class="overlay prev">←</a>

    <a href="/ios-app/quick-thoughts/step4-basic-sharing-function.html" title="Step 4—Basic Sharing Function →" class="overlay next">→</a>


  </main>

  <footer>
    <small><a href='/'>Mobile Design Class</a>. &copy; 2015 by Makzan. All rights reserved.</small>
  </footer>

  <div id='overlay' class='out'>
    <img id='overlay-img' src=''>
    <div id='overlay-caption'></div>
  </div>

  <!-- © 2015 Thomas Seng Hin Mak. -->

  <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
  <script src="/js/smoothstate.js"></script>
  <script src="/js/prism.min.js"></script>
  <script src="/js/website.js"></script>
</body>
</html>