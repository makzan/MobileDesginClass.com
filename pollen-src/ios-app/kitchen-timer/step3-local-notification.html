<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Step 3—Local Notification | Modile Design Class</title>
  <link rel="stylesheet" href="/css/prism.css">
  <link rel="stylesheet" href="/css/reader.css">

  <!-- Typekit -->
  <script src="//use.typekit.net/lyx0zwz.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>
</head>
<body>
  <main id="main">
    <header>
      <p>
        <a id="chapter" href="/ios-app/kitchen-timer/index.html">Kitchen Timer</a>


      </p>
      <p>
        <a href='/'>Mobile Design Class</a>
      </p>
    </header>

    <article>
      <root><h1>Step 3—Local Notification</h1><p>We use LocalNotification to schedule the time up message.</p><aside><figure><img src="https://dl.dropboxusercontent.com/u/3079250/Public%20for%20MobileDesignClass/ios/Screen%20Shot%202015-05-18%20at%2012.19.57%20PM.png" alt="Prompting user for allowing notification." /><figcaption>Prompting user for allowing notification.</figcaption></figure></aside><figure><img src="https://dl.dropboxusercontent.com/u/3079250/Public%20for%20MobileDesignClass/ios/IMG_0274.jpg" alt="Properties for notification action." /><figcaption>Properties for notification action.</figcaption></figure><pre><code class="language-swift">UIApplication.sharedApplication().scheduleLocalNotification(notification)</code></pre><pre><code class="language-swift"><p>func registerNotification() {<br />    // type<br />    let type = UIUserNotificationType.Alert | UIUserNotificationType.Badge | UIUserNotificationType.Sound</p><p>// actions<br />    let action1 = UIMutableUserNotificationAction()<br />    action1.identifier = "EXTRA_30S"<br />    action1.title = "+30s"<br />    action1.activationMode = UIUserNotificationActivationMode.Background<br />    action1.destructive = false<br />    action1.authenticationRequired = false</p><p>// action category<br />    let category = UIMutableUserNotificationCategory()<br />    category.identifier = "EXTRA_TIME_CATEGORY"<br />    category.setActions([action1], forContext: UIUserNotificationActionContext.Default)<br />    category.setActions([action1], forContext: UIUserNotificationActionContext.Minimal)</p><p>// setting<br />    let setting = UIUserNotificationSettings(forTypes: type, categories: [category])</p><p>// really register<br />    UIApplication.sharedApplication().registerUserNotificationSettings(setting)<br />}</p><p>// MARK: - Scheduling notification</p><p>func scheduleNotificationWithInterval(seconds:NSTimeInterval) {<br />    let notification = UILocalNotification()<br />    notification.fireDate = NSDate(timeIntervalSinceNow: seconds)<br />    notification.timeZone = NSTimeZone.defaultTimeZone()<br />    notification.alertBody = "Time’s up"<br />    notification.alertAction = "Dismiss"<br />    notification.soundName = UILocalNotificationDefaultSoundName<br />    notification.applicationIconBadgeNumber = 0<br />    notification.category = "EXTRA_TIME_CATEGORY"</p><p>UIApplication.sharedApplication().scheduleLocalNotification(notification)<br />}</p><p>// MARK: - Managing existing notifications</p><p>func hasNotifications() -&gt; Bool {<br />    return UIApplication.sharedApplication().scheduledLocalNotifications.count &gt; 0<br />}</p><p>func removeAllNotifications() {<br />    UIApplication.sharedApplication().cancelAllLocalNotifications()<br />}</p></code></pre><p>At last, we prompt the user for registration.</p><pre><code class="language-swift">// register notification<br />LocalNotificationManager.sharedInstance.registerNotification()</code></pre><div><h2 id="by-the-way"><a href="#by-the-way">By the way</a></h2><li>There is no difference in user’s view for <em>remote notification</em> and <em>local notification</em></li><br /><li>We should carefully design when to prompt user for the notification permission. Asking the permission in wrong timing may result in deny.</li><br /><li>There is no way to programmatically trigger the prompt again after deny. User need to manuanlly turn on notification for your app inside the OS setting app.</li></div></root>
    </article>

    <nav>

      <a id="prev" href="/ios-app/kitchen-timer/step2-auto-layout.html">← Step 2—Adding Auto Layout</a>

      <a id="next" href="/ios-app/kitchen-timer/another-autolayout-example.html">Another AutoLayout example →</a>
    </nav>


    <a href="/ios-app/kitchen-timer/step2-auto-layout.html" title="← Step 2—Adding Auto Layout" class="overlay prev">←</a>

    <a href="/ios-app/kitchen-timer/another-autolayout-example.html" title="Another AutoLayout example →" class="overlay next">→</a>


  </main>

  <footer>
    <small><a href='/'>Mobile Design Class</a>. &copy; 2015 by Makzan. All rights reserved.</small>
  </footer>

  <div id='overlay' class='out'>
    <img id='overlay-img' src=''>
    <div id='overlay-caption'></div>
  </div>

  <!-- © 2015 Thomas Seng Hin Mak. -->

  <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
  <script src="/js/smoothstate.js"></script>
  <script src="/js/website.js"></script>

</body>
</html>